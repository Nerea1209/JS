<!DOCTYPE html>
<html>

<head>
    <title>OSO</title>
</head>

<body>

    <p><strong>Matriz inicial:</strong></p>
    <p id="matriz1"></p>

    <p><strong>Resultado:</strong></p>
    <p id="matriz2"></p>

        <script>
            let tablero = new Array();
            let maxx = 9;
            let maxy = 9;

            function aleatorio(min, max) {
                var horquilla = max - min;
                return Math.round(Math.random() * horquilla + min);
            }

            function rellena() {
                for (let i = 0; i < maxx; i++) {
                    tablero[i] = new Array();
                    for (let j = 0; j < maxy; j++) {
                        let num = aleatorio(1, 3);
                        if (num < 3) {
                            tablero[i][j] = "O";
                        } else {
                            tablero[i][j] = "S";
                        }
                    }
                }

            }

            imprimir(tablero, "matriz1");

            function resuelve() {
                //función que resuelve el juego
                for (let i = 0; i < maxx; i++) {
                    for (let j = 0; j < maxy; j++) {
                        oso(i, j);
                    }
                }

            }

            function oso(x, y) {
                // Izquierda
                let primeraOx = undefined;
                let primeraOy = undefined;
                if (tablero[x][y] == "S") {
                    console.log("Coordenadas de S: x = " + x + " , y = " + y);
                    for (let i = x - 1; i <= x + 1; i++) {
                        for (let j = y - 1; j <= y + 1; j++) {
                            if (i>= 0 && i<tablero.length && j>= 0 && j < tablero[i].length && tablero[i][j] == "O") {
                                console.log("Coordenadas de O: x = " + i + " , y = " + j);
                                if (primeraOx == undefined) {
                                    primeraOx = i;
                                    primeraOy = j;
                                } else {
                                    if (x == i && x == primeraOx) {
                                        console.log("Misma fila");
                                        tablero[x][y] = '_';
                                        tablero[i][j] = '_';
                                        tablero[primeraOx][primeraOy] = '_';
                                        break;
                                    } else if (y == j && y == primeraOy) {
                                        console.log("Misma columna");
                                        tablero[x][y] = '_';
                                        tablero[i][j] = '_';
                                        tablero[primeraOx][primeraOy] = '_';
                                        break;
                                    } else if ((x == i - 1 && primeraOx == i - 2) && (y == j - 1 && primeraOy == j - 2) ||
                                    (x == i + 1 && primeraOx == i + 2) && (y == j + 1 && primeraOy == j + 2)) {
                                        console.log("Misma diagonal");
                                        tablero[x][y] = '_';
                                        tablero[i][j] = '_';
                                        tablero[primeraOx][primeraOy] = '_';
                                        break;
                                    } else {
                                        console.log("No vale");
                                    }
                                }
                            }
                        }
                    }
                } else {
                    return 0;
                }
            }


            // Función para imprimir
            function imprimir(array, id) {
                for (let i = 0; i < array.length; i++) {
                    for (let j = 0; j < array[i].length; j++) {
                        document.getElementById(id).innerHTML += array[i][j] + "&nbsp;&nbsp;&nbsp;";
                    }
                    document.getElementById(id).innerHTML += "<br>";
                }
            }

            rellena();
            imprimir(tablero, "matriz1");
            console.log(JSON.parse(JSON.stringify(tablero)));
            resuelve();
            imprimir(tablero, "matriz2");
            console.log(tablero);

        </script>

</body>

</html>